<h1>Public::Top#top</h1>
<p>Find me in app/views/public/top/top.html.erb</p>

<% if user_signed_in? || local_signed_in? || admin_signed_in? %>

<div class="container"><div class="row">
<div class="col-sm-8">
	<%= link_to reports_path do %>
		<h3>波情報</h3>
	<% end %>
	<h3>最新レビュー</h3>
	<% @reports.each do |report| %>
		<% if report.created_at.strftime('%Y-%m-%d') == Date.today.to_s %>
			<%= link_to report_path(report) do %>
				<%= attachment_image_tag report, :report_image, fallback: "no-image.png", :size => "100x100" %>
			<% end %>
			<table>
				<tr><th>ユーザー</th><td><%= report.user.user_name %></td></tr>
				<tr><th>日付</th><td><%= report.created_at.strftime('%Y-%m-%d') %></td></tr>
				<tr><th>スポット</th><td><%= report.spot.name %></td></tr>
				<tr><th>波評価</th><td><div id="star-rate-<%= report.id %>"></div></td></tr>
					<script>
						$('#star-rate-<%= report.id %>').raty({
							size      : 36,
							number    : 5,
							starOff   : '<%= asset_path('star-off.png') %>',
							starOn    : '<%= asset_path('star-on.png') %>',
							starHalf  : '<%= asset_path('star-half.png') %>',
							half      : true,
							readOnly  : true,
							score     : <%= report.rate %>,
						});
					</script>
				<tr><th>サイズ</th><td><%= report.size %></td></tr>
			</table>
		<% end %>
	<% end %>
</div>
<div class="col-sm-4">
<%= link_to forecasts_path do %>
<h3>波予報</h3>
<% end %>
<h3>明日の波</h3>
<% @forecasts.each do |forecast| %>
<% if forecast.date == Date.tomorrow.to_s %>
	<table>
		<tr>
			<th>ユーザーネーム</th>
			<td colspan="4"><%= forecast.local.user_name %></td>
		</tr>
		<tr>
			<th>スポット名</th>
			<td colspan="4"><%= forecast.spot.name %></td>
		</tr>
		<tr>
			<th>評価</th>
			<td colspan="4"><div id="star-rate2-<%= forecast.id %>"></div>
			<script>
				$('#star-rate2-<%= forecast.id %>').raty({
					size      : 36,
					numberMux : 5,
					starOff   : '<%= asset_path('star-off.png') %>',
					starOn    : '<%= asset_path('star-on.png') %>',
					starHalf  : '<%= asset_path('star-half.png') %>',
					half      : true,
					readOnly  : true,
					score     : <%= forecast.rate %>,
				});
			</script></td>
		</tr>
		<tr><th>サイズ</th><td colspan="4"><%= forecast.size %></td></tr>
		<tr><th>日付</th><td colspan="4"><%= forecast.date %></td></tr>
	</tr>
	</table>
<% end %>
<% end %>
</div></div></div>

<% else %>
<h1>ログインしてください</h1>
<div class="container"><div class="row"><div class="col-sm-8">
<h3>波情報</h3>
	<% @reports.each do |report| %>
		<%= attachment_image_tag report, :report_image, fallback: "no-image.png", :size => "100x100" %>
		<table>
			<tr><th>スポット</th><td><%= report.spot.name %></td></tr>
			<tr><th>波評価</th><td><div id="star-rate-<%= report.id %>"></div></td></tr>
				<script>
					$('#star-rate-<%= report.id %>').raty({
						size      : 36,
						numberMax : 5,
						starOff   : '<%= asset_path('star-off.png') %>',
						starOn    : '<%= asset_path('star-on.png') %>',
						starHalf  : '<%= asset_path('star-half.png') %>',
						half      : true,
						readOnly  : true,
						score     : <%= report.rate %>,
					});
				</script>
			<tr><th>サイズ</th><td><%= report.size %></td></tr>
		</table>
	<% end %>
</div>
<div class="col-sm-4">
<h3>波予報</h3>
<% @forecasts.each do |forecast| %>
	<table>
		<tr>
			<th>スポット名</th>
			<td colspan="4"><%= forecast.spot.name %></td>
		</tr>
		<tr>
			<th>評価</th>
			<td colspan="4"><div id="star-rate2-<%= forecast.id %>"></div>
			<script>
				$('#star-rate2-<%= forecast.id %>').raty({
					size      : 50,
					starOff   : '<%= asset_path('star-off.png') %>',
					starOn    : '<%= asset_path('star-on.png') %>',
					starHalf  : '<%= asset_path('star-half.png') %>',
					half      : true,
					readOnly  : true,
					score     : <%= forecast.rate %>,
				});
			</script></td>
		</tr>
		<tr><th>サイズ</th><td colspan="4"><%= forecast.size %></td></tr>
		<tr><th>日付</th><td colspan="4"><%= forecast.date %></td></tr>
	</table>
<% end %>
</div></div></div>
<% end %>
